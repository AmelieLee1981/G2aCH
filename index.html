<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åœ‹èªå°é”äººï¼šå…¨æ–¹ä½ç·´ç¿’</title>
    <style>
        :root {
            --bg-color: #fffdf5;
            --primary-color: #FFB74D;
            --accent-color: #4DD0E1;
            --success-color: #81C784;
            --error-color: #E57373;
            --text-main: #5D4037;
            --grid-border: #FF8A65;
        }

        html, body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: "Microsoft JhengHei", "KaiTi", "BiauKai", sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#FFCC80 15%, transparent 16%), radial-gradient(#80DEEA 15%, transparent 16%);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-main);
        }

        .layout-width {
            width: 90%;
            max-width: 500px;
            box-sizing: border-box;
        }

        header {
            background-color: #fff;
            padding: 10px 0;
            border-radius: 50px;
            text-align: center;
            box-shadow: 0 6px 0 rgba(0,0,0,0.1);
            border: 3px solid #FFCC80;
            position: relative;
            z-index: 10;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        h1 {
            margin: 0;
            font-size: 1.6rem;
            color: #FF9800;
            text-shadow: 1px 1px 0px #FFF3E0;
            letter-spacing: 2px;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 20px 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
            min-height: 60vh; 
            max-height: 80vh; 
            overflow-y: auto;
        }

        .game-container::-webkit-scrollbar { width: 0; }

        .level-indicator {
            font-size: 1.1rem;
            color: #90A4AE;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .progress-wrapper {
            width: 100%;
            height: 10px;
            background-color: #ECEFF1;
            border-radius: 10px;
            margin-bottom: 15px;
            overflow: hidden;
            border: 2px solid #CFD8DC;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--accent-color);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .word-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: #FFF3E0;
            border-radius: 20px;
            border: 3px dashed #FFCC80;
            width: 100%;
            box-sizing: border-box;
        }

        .char-container {
            display: flex;
            align-items: center;
            background: white;
            padding: 5px;
            border-radius: 10px;
            box-shadow: 0 3px 0 rgba(0,0,0,0.05);
        }

        .grid-box {
            width: 55px;
            height: 55px;
            border: 2px solid var(--grid-border);
            border-radius: 8px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: "KaiTi", "BiauKai", serif;
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            background: #fff;
            line-height: 1;
        }
        .grid-box::before { content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 1px; background: repeating-linear-gradient(90deg, var(--grid-border) 0, var(--grid-border) 4px, transparent 4px, transparent 8px); opacity: 0.5; }
        .grid-box::after { content: ''; position: absolute; left: 50%; top: 0; height: 100%; width: 1px; background: repeating-linear-gradient(0deg, var(--grid-border) 0, var(--grid-border) 4px, transparent 4px, transparent 8px); opacity: 0.5; }
        .grid-content { z-index: 1; position: relative; }
        
        .grid-box.empty {
            background-color: #FFFDE7;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px #E0F7FA;
        }
        
        .grid-box.highlight {
            background-color: #E1F5FE;
            border-color: #29B6F6;
        }

        .zhuyin-wrapper {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 55px;
            margin-left: 4px;
        }
        .zhuyin-bopo-col { display: flex; flex-direction: column; align-items: center; line-height: 1.1; font-size: 0.9rem; color: #555; font-weight: bold; font-family: "KaiTi", serif;}
        .zhuyin-tone-side { position: absolute; right: -5px; top: 50%; transform: translateY(-50%); font-size: 0.9rem; color: #555; font-weight: bold; }
        .zhuyin-tone-top { position: absolute; top: -5px; left: 50%; transform: translateX(-50%); font-size: 1rem; color: #555; font-weight: bold; line-height: 1; }

        .options-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
            margin-bottom: 15px;
        }

        .option-btn {
            width: 80px;
            height: 80px;
            background-color: white;
            border: 2px solid #E0E0E0;
            border-radius: 15px;
            padding: 0;
            font-size: 3rem;
            font-weight: bold;
            color: #555;
            font-family: "Microsoft JhengHei";
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 6px 0 #cfd8dc;
            transition: all 0.1s;
        }
        
        .option-btn.zhuyin-mode { font-family: "KaiTi", serif; font-size: 2.5rem; }
        
        .option-btn:active { transform: translateY(6px); box-shadow: 0 0 0 #cfd8dc; border-color: #ccc; }
        .option-btn.correct { background-color: var(--success-color); color: white; border-color: #66BB6A; box-shadow: 0 6px 0 #43A047; }
        .option-btn.correct:active { box-shadow: 0 0 0 #43A047; }
        .option-btn.wrong { background-color: var(--error-color); color: white; border-color: #EF5350; box-shadow: 0 6px 0 #D32F2F; animation: shake 0.4s; }

        .footer-controls {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-top: auto;
        }

        .func-btn {
            width: 90%;
            max-width: 280px;
            padding: 10px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            border: none;
            transition: transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: "Microsoft JhengHei";
        }

        .func-btn:active { transform: scale(0.95); }

        .btn-teach { background: #AB47BC; color: white; box-shadow: 0 4px 0 #8E24AA; }
        .btn-home { background: #8D6E63; color: white; box-shadow: 0 4px 0 #6D4C41; }

        .menu-btn {
            background: white;
            border: 3px solid var(--accent-color);
            border-radius: 25px;
            padding: 12px;
            width: 100%;
            max-width: 280px;
            margin: 8px 0;
            font-size: 1.3rem;
            color: #0097A7;
            font-weight: bold;
            box-shadow: 0 5px 0 #B2EBF2;
            cursor: pointer;
            transition: transform 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .menu-btn:active { transform: translateY(5px); box-shadow: none; }
        .menu-btn span { font-size: 0.8rem; color: #80DEEA; margin-top: 3px; font-weight: normal;}

        #feedback { 
            height: 30px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.3rem; 
            font-weight: bold; 
            margin-bottom: 5px;
            text-shadow: 1px 1px 0 #fff;
        }

        @keyframes shake { 10%, 90% { transform: translateX(-5px); } 40%, 60% { transform: translateX(5px); } }

        .review-card {
            background: #fff;
            border-radius: 15px;
            padding: 10px 15px;
            margin-bottom: 10px;
            border: 2px solid #EEE;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            box-sizing: border-box;
            box-shadow: 0 3px 0 #EEE;
        }
        
        /* 
           ä¿®æ”¹è™•ï¼šç§»é™¤ç©æœ¨èƒŒæ™¯ï¼Œæ”¹ç‚ºç´…è‰²æ–‡å­— 
        */
        .review-correct-char {
            display: inline-block;
            background: none; /* ç§»é™¤èƒŒæ™¯ */
            color: #e74c3c; /* ç´…è‰²å­—é«” */
            font-size: 2.2rem;
            font-weight: bold;
            font-family: "KaiTi", serif;
            margin: 0 2px;
            vertical-align: bottom;
            box-shadow: none; /* ç§»é™¤é™°å½± */
        }

        /* æ³¨éŸ³å°ˆç”¨æ¨£å¼ - ç›´å¼ */
        .review-correct-char.zhuyin {
            font-size: 1.2rem; 
            writing-mode: vertical-rl;
            text-orientation: upright;
            letter-spacing: -2px;
            font-family: "BiauKai", "KaiTi", serif;
            margin: 0 5px;
            vertical-align: middle;
            color: #e74c3c; /* ç´…è‰²å­—é«” */
        }
        
        .review-text {
            font-size: 1.5rem;
            color: #555;
            font-family: "KaiTi", serif;
            display: flex;
            align-items: center;
        }

        #time-result {
            font-size: 1.2rem;
            color: #7f8c8d;
            margin-bottom: 10px;
            font-weight: bold;
        }

        @media (min-width: 768px) {
            .grid-box { width: 90px; height: 90px; font-size: 3.5rem; }
            .zhuyin-wrapper { width: 32px; height: 90px; }
            .zhuyin-bopo-col { font-size: 1.2rem; }
            .option-btn { width: 110px; height: 110px; font-size: 4rem; }
        }
    </style>
</head>
<body>

<canvas id="confetti-canvas" style="position:fixed; top:0; left:0; pointer-events:none; z-index:99;"></canvas>

<header class="layout-width">
    <h1>åœ‹èªå°é”äºº</h1>
</header>

<div id="home-screen" class="game-container layout-width" style="justify-content: center; border: 4px solid #B3E5FC;">
    <img src="https://img.icons8.com/color/96/reading.png" alt="icon" style="margin-bottom:10px; width: 80px; height: 80px;">
    
    <button class="menu-btn" onclick="startGame('word')">
        ğŸ–ï¸ èªè©å¡«å¡«çœ‹
        <span>é¸å‡ºç”Ÿå­—å¡«å…¥æ ¼å­</span>
    </button>
    
    <button class="menu-btn" onclick="startGame('polyphone')" style="border-color: #FFB74D; color: #F57C00; box-shadow: 0 5px 0 #FFE0B2;">
        ğŸ—£ï¸ å¤šéŸ³å­—è€ƒé©—
        <span>é¸å‡ºæ­£ç¢ºçš„è®€éŸ³</span>
    </button>

    <button class="menu-btn" onclick="startGame('similar')" style="border-color: #81C784; color: #388E3C; box-shadow: 0 5px 0 #C8E6C9;">
        ğŸ‘€ ç›¸ä¼¼å­—æ¯”ä¸€æ¯”
        <span>é¸å‡ºæ­£ç¢ºçš„åœ‹å­—</span>
    </button>
</div>

<div id="game-screen" style="display:none;" class="game-container layout-width">
    <div class="level-indicator">ç¬¬ <span id="current-level">1</span> / <span id="total-levels">10</span> é¡Œ</div>
    <div class="progress-wrapper">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <div id="feedback"></div>

    <div class="word-grid" id="word-grid"></div>
    
    <div class="options-container" id="options-container"></div>

    <div class="footer-controls">
        <button class="func-btn btn-teach" onclick="teachMe()">
            ğŸ£ è«‹æ•™æ•™æˆ‘ (çœ‹ç­”æ¡ˆ)
        </button>
        
        <button class="func-btn btn-home" onclick="goHomeConfirm()">
            ğŸ  å›é¦–é 
        </button>
    </div>
</div>

<div id="complete-screen" style="display:none; justify-content: center;" class="game-container layout-width">
    <h2 style="color:#FF7043; margin: 10px 0;">ğŸ‰ ç·´ç¿’å®Œæˆï¼</h2>
    <div id="final-score" style="font-size: 1.5rem; margin-bottom: 5px; color:#555;"></div>
    <div id="time-result"></div>
    
    <div id="review-container" style="width:100%; display:none; max-height: 40vh; overflow-y:auto; margin-bottom: 15px;">
        <h3 style="color:#E57373; text-align:left; border-bottom: 2px dashed #ffcccb; padding-bottom:5px; font-size: 1.2rem;">ğŸ“ æˆ‘å€‘ä¾†è¤‡ç¿’ä¸€ä¸‹ï¼š</h3>
        <div id="review-items"></div>
    </div>

    <div style="margin-top:auto; display:flex; gap:10px; width: 100%; justify-content: center;">
        <button class="func-btn btn-home" style="width:auto; padding:10px 20px;" onclick="goHome()">å›é¦–é </button>
        <button class="func-btn btn-teach" style="width:auto; padding:10px 20px; background:#66BB6A; box-shadow:0 4px 0 #43A047;" onclick="restartLevel()">å†ç©ä¸€æ¬¡</button>
    </div>
</div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        if (audioCtx.state === 'suspended') {
            audioCtx.resume();
        }

        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();

        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        const now = audioCtx.currentTime;

        if (type === 'correct') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, now);
            osc.frequency.exponentialRampToValueAtTime(1046.50, now + 0.1);
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
            osc.start(now);
            osc.stop(now + 0.5);
        } else if (type === 'wrong') {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.linearRampToValueAtTime(100, now + 0.3);
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            osc.start(now);
            osc.stop(now + 0.3);
        }
    }

    const wordBank = [
        { phrase: ["èµ¤", "è…³"], zhuyin: ["ã„”Ë‹", "ã„ã„§ã„ Ë‡"], missingIndex: 0, answer: "èµ¤", options: ["èµ¤", "ç´…", "èµ°"] },
        { phrase: ["åœ‹", "å®¶"], zhuyin: ["ã„ã„¨ã„›ËŠ", "ã„ã„§ã„š"], missingIndex: 0, answer: "åœ‹", options: ["åœ‹", "åœ–", "åœ"] },
        { phrase: ["ç†±", "æ¹¯"], zhuyin: ["ã„–ã„œË‹", "ã„Šã„¤"], missingIndex: 0, answer: "ç†±", options: ["ç†±", "ç†Ÿ", "ç‡™"] },
        { phrase: ["ç‡™", "æ‰‹"], zhuyin: ["ã„Šã„¤Ë‹", "ã„•ã„¡Ë‡"], missingIndex: 0, answer: "ç‡™", options: ["ç‡™", "æ¹¯", "ç†±"] },
        { phrase: ["çš‡", "å®®"], zhuyin: ["ã„ã„¨ã„¤ËŠ", "ã„ã„¨ã„¥"], missingIndex: 1, answer: "å®®", options: ["å®®", "å®˜", "å…¬"] },
        { phrase: ["æ¶¼", "å¿«"], zhuyin: ["ã„Œã„§ã„¤ËŠ", "ã„ã„¨ã„Ë‹"], missingIndex: 0, answer: "æ¶¼", options: ["æ¶¼", "å†·", "å†°"] },
        { phrase: ["è¸©", "è¸"], zhuyin: ["ã„˜ã„Ë‡", "ã„Šã„šË‹"], missingIndex: 0, answer: "è¸©", options: ["è¸©", "æ¡", "å½©"] },
        { phrase: ["åœ°", "æ¯¯"], zhuyin: ["ã„‰ã„§Ë‹", "ã„Šã„¢Ë‡"], missingIndex: 1, answer: "æ¯¯", options: ["æ¯¯", "æ¯›", "æ°ˆ"] },
        { phrase: ["æº«", "æš–"], zhuyin: ["ã„¨ã„£", "ã„‹ã„¨ã„¢Ë‡"], missingIndex: 1, answer: "æš–", options: ["æš–", "æ´", "ç·©"] },
        { phrase: ["é¦¬", "è·¯"], zhuyin: ["ã„‡ã„šË‡", "ã„Œã„¨Ë‹"], missingIndex: 0, answer: "é¦¬", options: ["é¦¬", "é³¥", "å³¶"] },
        { phrase: ["å£", "äºº"], zhuyin: ["ã„ã„¨ã„Ë‹", "ã„–ã„£ËŠ"], missingIndex: 0, answer: "å£", options: ["å£", "æ‡·", "ç’°"] },
        { phrase: ["å›°", "é›£"], zhuyin: ["ã„ã„¨ã„£Ë‹", "ã„‹ã„¢ËŠ"], missingIndex: 1, answer: "é›£", options: ["é›£", "æº–", "èª°"] },
        { phrase: ["æ±º", "å®š"], zhuyin: ["ã„ã„©ã„ËŠ", "ã„‰ã„§ã„¥Ë‹"], missingIndex: 1, answer: "å®š", options: ["å®š", "è¶³", "æ˜¯"] },
        { phrase: ["éš¨", "ä¾¿"], zhuyin: ["ã„™ã„¨ã„ŸËŠ", "ã„…ã„§ã„¢Ë‹"], missingIndex: 0, answer: "éš¨", options: ["éš¨", "éš‹", "éšŠ"] },
        { phrase: ["ä¸»", "äºº"], zhuyin: ["ã„“ã„¨Ë‡", "ã„–ã„£ËŠ"], missingIndex: 0, answer: "ä¸»", options: ["ä¸»", "ç‹", "ç‰"] },
        { phrase: ["æ–¹", "æ³•"], zhuyin: ["ã„ˆã„¤", "ã„ˆã„šË‡"], missingIndex: 1, answer: "æ³•", options: ["æ³•", "å»", "ä¸Ÿ"] },
        { phrase: ["æ–¼", "æ˜¯"], zhuyin: ["ã„©ËŠ", "ã„•Ë‹"], missingIndex: 0, answer: "æ–¼", options: ["æ–¼", "æ–¹", "æ—"] },
        { phrase: ["èˆ’", "æœ"], zhuyin: ["ã„•ã„¨", "ã„ˆã„¨ËŠ"], missingIndex: 0, answer: "èˆ’", options: ["èˆ’", "æ¨", "é‡"] },
        { phrase: ["ä¸€", "ç¾¤"], zhuyin: ["ã„§", "ã„‘ã„©ã„£ËŠ"], missingIndex: 1, answer: "ç¾¤", options: ["ç¾¤", "å›", "ç¾Š"] },
        { phrase: ["å®‰", "éœ"], zhuyin: ["ã„¢", "ã„ã„§ã„¥Ë‹"], missingIndex: 1, answer: "éœ", options: ["éœ", "é’", "çˆ­"] },
        { phrase: ["æŠ¬", "é ­"], zhuyin: ["ã„Šã„ËŠ", "ã„Šã„¡ËŠ"], missingIndex: 0, answer: "æŠ¬", options: ["æŠ¬", "æ²»", "å°"] },
        { phrase: ["é", "å¸¸"], zhuyin: ["ã„ˆã„Ÿ", "ã„”ã„¤ËŠ"], missingIndex: 0, answer: "é", options: ["é", "é£›", "æ’"] },
        { phrase: ["æœ‰", "è¶£"], zhuyin: ["ã„§ã„¡Ë‡", "ã„‘ã„©Ë‹"], missingIndex: 1, answer: "è¶£", options: ["è¶£", "å–", "å»"] },
        { phrase: ["é™„", "è¿‘"], zhuyin: ["ã„ˆã„¨Ë‹", "ã„ã„§ã„£Ë‹"], missingIndex: 1, answer: "è¿‘", options: ["è¿‘", "é€²", "è½"] },
        { phrase: ["åœŸ", "å †"], zhuyin: ["ã„Šã„¨Ë‡", "ã„‰ã„¨ã„Ÿ"], missingIndex: 1, answer: "å †", options: ["å †", "æ¨", "å‡†"] },
        { phrase: ["å¿½", "ç„¶"], zhuyin: ["ã„ã„¨", "ã„–ã„¢ËŠ"], missingIndex: 0, answer: "å¿½", options: ["å¿½", "ç‰©", "å‹¿"] },
        { phrase: ["è½", "è¦‹"], zhuyin: ["ã„Šã„§ã„¥", "ã„ã„§ã„¢Ë‹"], missingIndex: 0, answer: "è½", options: ["è½", "è¿‘", "å¾·"] },
        { phrase: ["æ®", "æ‰‹"], zhuyin: ["ã„ã„¨ã„Ÿ", "ã„•ã„¡Ë‡"], missingIndex: 0, answer: "æ®", options: ["æ®", "è¼", "æ¸¾"] },
        { phrase: ["æ…¢", "æ…¢"], zhuyin: ["ã„‡ã„¢Ë‹", "ã„‡ã„¢Ë‹"], missingIndex: 0, answer: "æ…¢", options: ["æ…¢", "æ¼«", "è”“"] },
        { phrase: ["ä¾", "ä¾", "ä¸", "æ¨"], zhuyin: ["ã„§", "ã„§", "ã„…ã„¨Ë‹", "ã„•ã„œË‡"], missingIndex: 3, answer: "æ¨", options: ["æ¨", "èˆ", "èˆŒ"] },
        { phrase: ["ä»Š", "å¤©"], zhuyin: ["ã„ã„§ã„£", "ã„Šã„§ã„¢"], missingIndex: 0, answer: "ä»Š", options: ["ä»Š", "ä»¤", "å«"] },
        { phrase: ["ç”š", "è‡³"], zhuyin: ["ã„•ã„£Ë‹", "ã„“Ë‹"], missingIndex: 1, answer: "è‡³", options: ["è‡³", "åˆ°", "åœ¨"] },
        { phrase: ["å¦¹", "å¦¹"], zhuyin: ["ã„‡ã„ŸË‹", "Ë™ã„‡ã„Ÿ"], missingIndex: 0, answer: "å¦¹", options: ["å¦¹", "å‘³", "æŠ¹"] },
        { phrase: ["ä¸Š", "å‡"], zhuyin: ["ã„•ã„¤Ë‹", "ã„•ã„¥"], missingIndex: 1, answer: "å‡", options: ["å‡", "ç”Ÿ", "è²"] },
        { phrase: ["å¤ª", "é™½"], zhuyin: ["ã„Šã„Ë‹", "ã„§ã„¤ËŠ"], missingIndex: 1, answer: "é™½", options: ["é™½", "æ¹¯", "å ´"] },
        { phrase: ["åŸ", "å› "], zhuyin: ["ã„©ã„¢ËŠ", "ã„§ã„£"], missingIndex: 1, answer: "å› ", options: ["å› ", "å›°", "å›"] },
        { phrase: ["æ—¥", "æœŸ"], zhuyin: ["ã„–Ë‹", "ã„‘ã„§ËŠ"], missingIndex: 1, answer: "æœŸ", options: ["æœŸ", "å…¶", "æ——"] },
        { phrase: ["ç›¯", "è‘—"], zhuyin: ["ã„‰ã„§ã„¥", "Ë™ã„“ã„œ"], missingIndex: 0, answer: "ç›¯", options: ["ç›¯", "ä¸", "å®"] },
        { phrase: ["ç³¯", "ç±³", "åœ˜"], zhuyin: ["ã„‹ã„¨ã„›Ë‹", "ã„‡ã„§Ë‡", "ã„Šã„¨ã„¢ËŠ"], missingIndex: 2, answer: "åœ˜", options: ["åœ˜", "åœ’", "åœ‹"] },
        { phrase: ["éºµ", "ç²‰"], zhuyin: ["ã„‡ã„§ã„¢Ë‹", "ã„ˆã„£Ë‡"], missingIndex: 1, answer: "ç²‰", options: ["ç²‰", "åˆ†", "ç´›"] },
        { phrase: ["è®Š", "æˆ"], zhuyin: ["ã„…ã„§ã„¢Ë‹", "ã„”ã„¥ËŠ"], missingIndex: 0, answer: "è®Š", options: ["è®Š", "å½", "æˆ€"] },
        { phrase: ["å—", "æ–¹"], zhuyin: ["ã„‹ã„¢ËŠ", "ã„ˆã„¤"], missingIndex: 0, answer: "å—", options: ["å—", "é›£", "æŸ“"] },
        { phrase: ["é»ƒ", "è‰²"], zhuyin: ["ã„ã„¨ã„¤ËŠ", "ã„™ã„œË‹"], missingIndex: 0, answer: "é»ƒ", options: ["é»ƒ", "å»£", "å…±"] },
        { phrase: ["çœŸ", "æ­£"], zhuyin: ["ã„“ã„£", "ã„“ã„¥Ë‹"], missingIndex: 0, answer: "çœŸ", options: ["çœŸ", "ç›´", "å…·"] },
        { phrase: ["ç¬‘", "å‘µ", "å‘µ"], zhuyin: ["ã„’ã„§ã„ Ë‹", "ã„ã„œ", "ã„ã„œ"], missingIndex: 1, answer: "å‘µ", options: ["å‘µ", "æ²³", "å¯"] },
        { phrase: ["æ¥", "å—"], zhuyin: ["ã„ã„§ã„", "ã„•ã„¡Ë‹"], missingIndex: 0, answer: "æ¥", options: ["æ¥", "æŒ‰", "æ ¡"] },
        { phrase: ["é‡", "ç‰›"], zhuyin: ["ã„§ã„Ë‡", "ã„‹ã„§ã„¡ËŠ"], missingIndex: 0, answer: "é‡", options: ["é‡", "é‡Œ", "ä¹Ÿ"] },
        { phrase: ["æœ¬", "ä¾†"], zhuyin: ["ã„…ã„£Ë‡", "ã„Œã„ËŠ"], missingIndex: 0, answer: "æœ¬", options: ["æœ¬", "æœ¨", "å¤§"] },
        { phrase: ["æ¨¡", "å‹"], zhuyin: ["ã„‡ã„›ËŠ", "ã„’ã„§ã„¥ËŠ"], missingIndex: 1, answer: "å‹", options: ["å‹", "å½¢", "åˆ‘"] },
        { phrase: ["èœœ", "èœ‚"], zhuyin: ["ã„‡ã„§Ë‹", "ã„ˆã„¥"], missingIndex: 0, answer: "èœœ", options: ["èœœ", "å¯†", "ç§˜"] },
        { phrase: ["è´", "è¶"], zhuyin: ["ã„ã„¨ËŠ", "ã„‰ã„§ã„ËŠ"], missingIndex: 1, answer: "è¶", options: ["è¶", "è«œ", "è‘‰"] },
        { phrase: ["é£›", "ç¿”"], zhuyin: ["ã„ˆã„Ÿ", "ã„’ã„§ã„¤ËŠ"], missingIndex: 0, answer: "é£›", options: ["é£›", "é", "è²"] },
        { phrase: ["ç”Ÿ", "æ´»"], zhuyin: ["ã„•ã„¥", "ã„ã„¨ã„›ËŠ"], missingIndex: 1, answer: "æ´»", options: ["æ´»", "è©±", "æ‹¬"] },
        { phrase: ["åœ–", "ç•«"], zhuyin: ["ã„Šã„¨ËŠ", "ã„ã„¨ã„šË‹"], missingIndex: 0, answer: "åœ–", options: ["åœ–", "åœ‹", "åœ˜"] },
        { phrase: ["é‰›", "ç­†"], zhuyin: ["ã„‘ã„§ã„¢", "ã„…ã„§Ë‡"], missingIndex: 1, answer: "ç­†", options: ["ç­†", "æ¯”", "æ¯›"] },
        { phrase: ["é£²", "æ–™"], zhuyin: ["ã„§ã„£Ë‡", "ã„Œã„§ã„ Ë‹"], missingIndex: 1, answer: "æ–™", options: ["æ–™", "ç§‘", "æŠ–"] },
        { phrase: ["æ¹–", "æ°´"], zhuyin: ["ã„ã„¨ËŠ", "ã„•ã„¨ã„ŸË‡"], missingIndex: 0, answer: "æ¹–", options: ["æ¹–", "å£º", "èƒ¡"] },
        { phrase: ["èª¿", "å‘³"], zhuyin: ["ã„Šã„§ã„ ËŠ", "ã„¨ã„ŸË‹"], missingIndex: 0, answer: "èª¿", options: ["èª¿", "å‡‹", "é€±"] },
        { phrase: ["éµ", "ç›¤"], zhuyin: ["ã„ã„§ã„¢Ë‹", "ã„†ã„¢ËŠ"], missingIndex: 1, answer: "ç›¤", options: ["ç›¤", "ç›†", "ç››"] },
        { phrase: ["è¿·", "è·¯"], zhuyin: ["ã„‡ã„§ËŠ", "ã„Œã„¨Ë‹"], missingIndex: 0, answer: "è¿·", options: ["è¿·", "ç±³", "è¬"] },
        { phrase: ["é€›", "è¡—"], zhuyin: ["ã„ã„¨ã„¤Ë‹", "ã„ã„§ã„"], missingIndex: 0, answer: "é€›", options: ["é€›", "ç‹‚", "æ—º"] },
        { phrase: ["èŠ±", "å…’"], zhuyin: ["ã„ã„¨ã„š", "ã„¦"], missingIndex: 1, answer: "å…’", options: ["å…’", "å…„", "è¦‹"] },
        { phrase: ["æ£‰", "èŠ±"], zhuyin: ["ã„‡ã„§ã„¢ËŠ", "ã„ã„¨ã„š"], missingIndex: 0, answer: "æ£‰", options: ["æ£‰", "ç¶¿", "éŒ¦"] },
        { phrase: ["å¤§", "æ¨¹"], zhuyin: ["ã„‰ã„šË‹", "ã„•ã„¨Ë‹"], missingIndex: 1, answer: "æ¨¹", options: ["æ¨¹", "æ", "æ‘"] },
        { phrase: ["çœ‹", "å®¶"], zhuyin: ["ã„ã„¢", "ã„ã„§ã„š"], missingIndex: 0, answer: "çœ‹", options: ["çœ‹", "çœŸ", "ç›®"] },
        { phrase: ["å‡", "é«®"], zhuyin: ["ã„ã„§ã„šË‡", "ã„ˆã„šË‡"], missingIndex: 0, answer: "å‡", options: ["å‡", "æš‡", "ç”²"] },
        { phrase: ["æš–", "å’Œ"], zhuyin: ["ã„‹ã„¨ã„¢Ë‡", "ã„ã„¨ã„›Ë™"], missingIndex: 1, answer: "å’Œ", options: ["å’Œ", "çŸ¥", "åˆ©"] },
        { phrase: ["è¹º", "è¹º", "æ¿"], zhuyin: ["ã„‘ã„§ã„ ", "ã„‘ã„§ã„ ", "ã„…ã„¢Ë‡"], missingIndex: 0, answer: "è¹º", options: ["è¹º", "ç¿¹", "æ¾†"] },
        { phrase: ["é ", "æ–¹"], zhuyin: ["ã„©ã„¢Ë‡", "ã„ˆã„¤"], missingIndex: 0, answer: "é ", options: ["é ", "å…ƒ", "é€Ÿ"] },
        { phrase: ["é¢¨", "æ™¯"], zhuyin: ["ã„ˆã„¥", "ã„ã„§ã„¥Ë‡"], missingIndex: 1, answer: "æ™¯", options: ["æ™¯", "å½±", "äº¬"] },
        { phrase: ["æ”¾", "å­¸"], zhuyin: ["ã„ˆã„¤Ë‹", "ã„’ã„©ã„ËŠ"], missingIndex: 0, answer: "æ”¾", options: ["æ”¾", "æ”¶", "æ”¹"] },
        { phrase: ["å®ˆ", "æ ª", "å¾…", "å…”"], zhuyin: ["ã„•ã„¡Ë‡", "ã„“ã„¨", "ã„‰ã„Ë‹", "ã„Šã„¨Ë‹"], missingIndex: 3, answer: "å…”", options: ["å…”", "å…", "æ™š"] },
	{ phrase: ["ç§»", "èŠ±", "æ¥", "æœ¨"], zhuyin: ["ã„§ËŠ", "ã„ã„¨ã„š", "ã„ã„§ã„", "ã„‡ã„¨Ë‹"], missingIndex: 1, answer: "èŠ±", options: ["è‰", "æ¨¹", "èŠ±"] },
	{ phrase: ["å°", "ç‰›", "å½ˆ", "ç´"], zhuyin: ["ã„‰ã„¨ã„ŸË‹", "ã„‹ã„§ã„¡ËŠ", "ã„Šã„¢ËŠ", "ã„‘ã„§ã„£ËŠ"], missingIndex: 1, answer: "ç‰›", options: ["ç‰›", "é¦¬", "æœ¨"] },
	{ phrase: ["ä¸€", "æ°£", "å‘µ", "æˆ"], zhuyin: ["ã„§ËŠ", "ã„‘ä¸€Ë‹", "ã„ã„œ", "ã„”ã„¥ËŠ"], missingIndex: 2, answer: "å‘µ", options: ["å–", "åˆ»", "å‘µ"] },
        { phrase: ["å¿ƒ", "èŠ±", "æ€’", "æ”¾"], zhuyin: ["ã„’ã„§ã„£", "ã„ã„¨ã„š", "ã„‹ã„¨Ë‹", "ã„ˆã„¤Ë‹"], missingIndex: 3, answer: "æ”¾", options: ["æ–¹", "æ”¾", "æ³•"] },
	{ phrase: ["å¹³", "å¿ƒ", "éœ", "æ°£"], zhuyin: ["ã„†ã„§ã„¥ËŠ", "ã„’ã„§ã„£", "ã„ã„§ã„¥Ë‹", "ã„‘ä¸€Ë‹"], missingIndex: 2, answer: "éœ", options: ["æ·¨", "æ•¬", "éœ"] },
	{ phrase: ["å£", "æ˜¯", "å¿ƒ", "é"], zhuyin: ["ã„ã„¡Ë‡", "ã„•Ë‹", "ã„’ã„§ã„£", "ã„ˆã„Ÿ"], missingIndex: 3, answer: "é", options: ["é£›", "è²", "é"] },
	{ phrase: ["å¹¸", "ç½", "æ¨‚", "ç¦"], zhuyin: ["ã„’ã„§ã„¥Ë‹", "ã„—ã„", "ã„Œã„œË‹", "ã„ã„¨ã„›Ë‹"], missingIndex: 0, answer: "å¹¸", options: ["è¾›", "å¹¸", "æ–°"] },

        { phrase: ["è¾²", "å¤«"], zhuyin: ["ã„‹ã„¨ã„¥ËŠ", "ã„ˆã„¨"], missingIndex: 0, answer: "è¾²", options: ["è¾²", "æ¿ƒ", "è¡£"] },
        { phrase: ["å¤«", "å¦»"], zhuyin: ["ã„ˆã„¨", "ã„‘ä¸€"], missingIndex: 0, answer: "å¤«", options: ["çˆ¶", "å¤«", "ä»˜"] },
	{ phrase: ["è€•", "ç¨®"], zhuyin: ["ã„ã„¥", "ã„“ã„¨ã„¥Ë‹"], missingIndex: 1, answer: "ç¨®", options: ["ç¨®", "é‡", "è…«"] },
        { phrase: ["å‰›", "å‰›"], zhuyin: ["ã„ã„¤", "ã„ã„¤"], missingIndex: 0, answer: "å‰›", options: ["å‰›", "é‹¼", "å´—"] },
        { phrase: ["è¶•", "è·¯"], zhuyin: ["ã„ã„¢Ë‡", "ã„Œã„¨Ë‹"], missingIndex: 0, answer: "è¶•", options: ["è¶•", "èµ·", "è¶£"] },
        { phrase: ["å¹¸", "é‹"], zhuyin: ["ã„’ã„§ã„¥Ë‹", "ã„©ã„£Ë‹"], missingIndex: 1, answer: "é‹", options: ["é‹", "é€£", "é "] },
        { phrase: ["ä»¥", "ç‚º"], zhuyin: ["ã„§Ë‡", "ã„¨ã„ŸËŠ"], missingIndex: 0, answer: "ä»¥", options: ["ä»¥", "ä¹™", "å·±"] },
        { phrase: ["å¤œ", "æ™š"], zhuyin: ["ã„§ã„Ë‹", "ã„¨ã„¢Ë‡"], missingIndex: 0, answer: "å¤œ", options: ["å¤œ", "æ¶²", "ä¾"] },
        { phrase: ["åŒ—", "æ–¹"], zhuyin: ["ã„…ã„ŸË‡", "ã„ˆã„¤"], missingIndex: 0, answer: "åŒ—", options: ["åŒ—", "æ¯”", "æ­¤"] },
        { phrase: ["æ’", "åˆ°"], zhuyin: ["ã„“ã„¨ã„¤Ë‹", "ã„‰ã„ Ë‹"], missingIndex: 0, answer: "æ’", options: ["æ’", "ç«¥", "é˜"] },
        { phrase: ["å¤", "å¤©"], zhuyin: ["ã„’ã„§ã„šË‹", "ã„Šã„§ã„¢"], missingIndex: 0, answer: "å¤", options: ["å¤", "å¤", "éº¥"] },
        { phrase: ["æ–", "é ­"], zhuyin: ["ã„§ã„ ËŠ", "ã„Šã„¡ËŠ"], missingIndex: 0, answer: "æ–", options: ["æ–", "é™", "è¬ "] },
        { phrase: ["ç­‰", "å¾…"], zhuyin: ["ã„‰ã„¥Ë‡", "ã„‰ã„Ë‹"], missingIndex: 0, answer: "ç­‰", options: ["ç­‰", "å¯º", "ç‰¹"] }
    ];

    const polyphoneBank = [
        { phrase: ["å‡", "æ—¥"], zhuyin: ["ã„ã„§ã„šË‹", "ã„–Ë‹"], targetIndex: 0, answer: "ã„ã„§ã„šË‹", options: ["ã„ã„§ã„šË‹", "ã„ã„§ã„šË‡"] },
        { phrase: ["çœŸ", "å‡"], zhuyin: ["ã„“ã„£", "ã„ã„§ã„šË‡"], targetIndex: 1, answer: "ã„ã„§ã„šË‡", options: ["ã„ã„§ã„šË‹", "ã„ã„§ã„šË‡"] },
        { phrase: ["ç¨®", "èŠ±"], zhuyin: ["ã„“ã„¨ã„¥Ë‹", "ã„ã„¨ã„š"], targetIndex: 0, answer: "ã„“ã„¨ã„¥Ë‹", options: ["ã„“ã„¨ã„¥Ë‹", "ã„“ã„¨ã„¥Ë‡"] },
        { phrase: ["ç¨®", "å­"], zhuyin: ["ã„“ã„¨ã„¥Ë‡", "ã„—Ë‡"], targetIndex: 0, answer: "ã„“ã„¨ã„¥Ë‡", options: ["ã„“ã„¨ã„¥Ë‹", "ã„“ã„¨ã„¥Ë‡"] },
        { phrase: ["éŸ³", "æ¨‚"], zhuyin: ["ã„§ã„£", "ã„©ã„Ë‹"], targetIndex: 1, answer: "ã„©ã„Ë‹", options: ["ã„©ã„Ë‹", "ã„Œã„œË‹"] },
        { phrase: ["å¿«", "æ¨‚"], zhuyin: ["ã„ã„¨ã„Ë‹", "ã„Œã„œË‹"], targetIndex: 1, answer: "ã„Œã„œË‹", options: ["ã„©ã„Ë‹", "ã„Œã„œË‹"] },
        { phrase: ["è¦º", "å¾—"], zhuyin: ["ã„ã„©ã„ËŠ", "Ë™ã„‰ã„œ"], targetIndex: 0, answer: "ã„ã„©ã„ËŠ", options: ["ã„ã„©ã„ËŠ", "ã„ã„§ã„ Ë‹"] },
        { phrase: ["ç¡", "è¦º"], zhuyin: ["ã„•ã„¨ã„ŸË‹", "ã„ã„§ã„ Ë‹"], targetIndex: 1, answer: "ã„ã„§ã„ Ë‹", options: ["ã„ã„©ã„ËŠ", "ã„ã„§ã„ Ë‹"] },
        { phrase: ["é•·", "å¤§"], zhuyin: ["ã„“ã„¤Ë‡", "ã„‰ã„šË‹"], targetIndex: 0, answer: "ã„“ã„¤Ë‡", options: ["ã„“ã„¤Ë‡", "ã„”ã„¤ËŠ"] },
        { phrase: ["é•·", "çŸ­"], zhuyin: ["ã„”ã„¤ËŠ", "ã„‰ã„¨ã„¢Ë‡"], targetIndex: 0, answer: "ã„”ã„¤ËŠ", options: ["ã„“ã„¤Ë‡", "ã„”ã„¤ËŠ"] },
        { phrase: ["é›£", "é"], zhuyin: ["ã„‹ã„¢ËŠ", "ã„ã„¨ã„›Ë‹"], targetIndex: 0, answer: "ã„‹ã„¢ËŠ", options: ["ã„‹ã„¢ËŠ", "ã„‹ã„¢Ë‹"] },
        { phrase: ["ç½", "é›£"], zhuyin: ["ã„—ã„", "ã„‹ã„¢Ë‹"], targetIndex: 1, answer: "ã„‹ã„¢Ë‹", options: ["ã„‹ã„¢ËŠ", "ã„‹ã„¢Ë‹"] },
        { phrase: ["æ›´", "åŠ "], zhuyin: ["ã„ã„¥Ë‹", "ã„ã„§ã„š"], targetIndex: 0, answer: "ã„ã„¥Ë‹", options: ["ã„ã„¥Ë‹", "ã„ã„¥"] },
        { phrase: ["ä¸‰", "æ›´"], zhuyin: ["ã„™ã„¢", "ã„ã„¥"], targetIndex: 1, answer: "ã„ã„¥", options: ["ã„ã„¥Ë‹", "ã„ã„¥"] },
        { phrase: ["èª¿", "æ•´"], zhuyin: ["ã„Šã„§ã„ ËŠ", "ã„“ã„¥Ë‡"], targetIndex: 0, answer: "ã„Šã„§ã„ ËŠ", options: ["ã„Šã„§ã„ ËŠ", "ã„‰ã„§ã„ Ë‹"] },
        { phrase: ["æ›²", "èª¿"], zhuyin: ["ã„‘ã„©Ë‡", "ã„‰ã„§ã„ Ë‹"], targetIndex: 1, answer: "ã„‰ã„§ã„ Ë‹", options: ["ã„Šã„§ã„ ËŠ", "ã„‰ã„§ã„ Ë‹"] },
        { phrase: ["çµ•", "ç¨®"], zhuyin: ["ã„ã„©ã„ËŠ", "ã„“ã„¨ã„¥Ë‡"], targetIndex: 1, answer: "ã„“ã„¨ã„¥Ë‡", options: ["ã„“ã„¨ã„¥Ë‡", "ã„“ã„¨ã„¥Ë‹"] },
        { phrase: ["æ", "åš‡"], zhuyin: ["ã„ã„¨ã„¥Ë‡", "ã„ã„œË‹"], targetIndex: 1, answer: "ã„ã„œË‹", options: ["ã„ã„œË‹", "ã„’ã„§ã„šË‹"] },
        { phrase: ["åš‡", "ä¸€", "è·³"], zhuyin: ["ã„’ã„§ã„šË‹", "ã„§", "ã„Šã„§ã„ Ë‹"], targetIndex: 0, answer: "ã„’ã„§ã„šË‹", options: ["ã„ã„œË‹", "ã„’ã„§ã„šË‹"] },
        { phrase: ["å–", "é‡‡"], zhuyin: ["ã„ã„œË‹", "ã„˜ã„Ë‡"], targetIndex: 0, answer: "ã„ã„œË‹", options: ["ã„ã„œË‹", "ã„ã„œ"] },
        { phrase: ["å–", "æ°´"], zhuyin: ["ã„ã„œ", "ã„•ã„¨ã„ŸË‡"], targetIndex: 0, answer: "ã„ã„œ", options: ["ã„ã„œË‹", "ã„ã„œ"] },
        { phrase: ["é‡", "è¦"], zhuyin: ["ã„“ã„¨ã„¥Ë‹", "ã„§ã„ Ë‹"], targetIndex: 0, answer: "ã„“ã„¨ã„¥Ë‹", options: ["ã„“ã„¨ã„¥Ë‹", "ã„”ã„¨ã„¥ËŠ"] },
        { phrase: ["é‡", "è¤‡"], zhuyin: ["ã„”ã„¨ã„¥ËŠ", "ã„ˆã„¨Ë‹"], targetIndex: 0, answer: "ã„”ã„¨ã„¥ËŠ", options: ["ã„“ã„¨ã„¥Ë‹", "ã„”ã„¨ã„¥ËŠ"] },
        { phrase: ["å…’", "ç«¥"], zhuyin: ["ã„¦ËŠ", "ã„Šã„¨ã„¥ËŠ"], targetIndex: 0, answer: "ã„¦ËŠ", options: ["ã„¦ËŠ", "ã„¦"] },
        { phrase: ["èŠ±", "å…’"], zhuyin: ["ã„ã„¨ã„š", "ã„¦"], targetIndex: 1, answer: "ã„¦", options: ["ã„¦ËŠ", "ã„¦"] },
        { phrase: ["å°", "çœ‹"], zhuyin: ["ã„’ã„§ã„ Ë‡", "ã„ã„¢Ë‹"], targetIndex: 1, answer: "ã„ã„¢Ë‹", options: ["ã„ã„¢Ë‹", "ã„ã„¢"] },
        { phrase: ["çœ‹", "å®¶", "æœ¬", "é ˜"], zhuyin: ["ã„ã„¢", "ã„ã„§ã„š", "ã„…ã„£Ë‡", "ã„Œã„§ã„¥Ë‡"], targetIndex: 0, answer: "ã„ã„¢", options: ["ã„ã„¢", "ã„ã„¢Ë‹"] },
        { phrase: ["æ›´", "æ›"], zhuyin: ["ã„ã„¥", "ã„ã„¨ã„¢Ë‹"], targetIndex: 0, answer: "ã„ã„¥", options: ["ã„ã„¥", "ã„ã„¥Ë‹"] },
        { phrase: ["ç‹", "å‡", "è™", "å¨"], zhuyin: ["ã„ã„¨ËŠ", "ã„ã„§ã„šË‡", "ã„ã„¨Ë‡", "ã„¨ã„Ÿ"], targetIndex: 1, answer: "ã„ã„§ã„šË‡", options: ["ã„ã„§ã„šË‡", "ã„ã„§ã„šË‹"] },
        { phrase: ["å‡", "é«®"], zhuyin: ["ã„ã„§ã„šË‡", "ã„ˆã„šË‡"], targetIndex: 0, answer: "ã„ã„§ã„šË‡", options: ["ã„ã„§ã„šË‡", "ã„ã„§ã„šË‹"] },
        { phrase: ["è½", "å¤©", "ç”±", "å‘½"], zhuyin: ["ã„Šã„§ã„¥Ë‹", "ã„Šã„§ã„¢", "ã„§ã„¡ËŠ", "ã„‡ã„§ã„¥Ë‹"], targetIndex: 0, answer: "ã„Šã„§ã„¥Ë‹", options: ["ã„Šã„§ã„¥", "ã„Šã„§ã„¥Ë‹"] },
        { phrase: ["å’Œ", "æ°£"], zhuyin: ["ã„ã„œËŠ", "ã„‘ã„§Ë‹"], targetIndex: 0, answer: "ã„ã„œËŠ", options: ["ã„ã„œËŠ", "ã„ã„œË‹", "ã„ã„¨ã„›Ë™"] },
        { phrase: ["ç¸½", "å’Œ"], zhuyin: ["ã„—ã„¨ã„¥Ë‡", "ã„ã„œËŠ"], targetIndex: 1, answer: "ã„ã„œËŠ", options: ["ã„ã„œËŠ", "ã„ã„œË‹"] },
        { phrase: ["å”±", "å’Œ"], zhuyin: ["ã„”ã„¤Ë‹", "ã„ã„œË‹"], targetIndex: 1, answer: "ã„ã„œË‹", options: ["ã„ã„œË‹", "ã„ã„œËŠ"] },
        { phrase: ["æš–", "å’Œ"], zhuyin: ["ã„‹ã„¨ã„¢Ë‡", "ã„ã„¨ã„›Ë™"], targetIndex: 1, answer: "ã„ã„¨ã„›Ë™", options: ["ã„ã„¨ã„›Ë™", "ã„ã„œËŠ"] },
        { phrase: ["å’Œ", "éºµ"], zhuyin: ["ã„ã„¨ã„›Ë‹", "ã„‡ã„§ã„¢Ë‹"], targetIndex: 0, answer: "ã„ã„¨ã„›Ë‹", options: ["ã„ã„¨ã„›Ë‹", "ã„ã„œËŠ"] },
        { phrase: ["æ”ª", "å’Œ"], zhuyin: ["ã„ã„§ã„ Ë‡", "ã„ã„¨ã„›Ë™"], targetIndex: 1, answer: "ã„ã„¨ã„›Ë™", options: ["ã„ã„¨ã„›Ë™", "ã„ã„œËŠ"] },
        { phrase: ["é™„", "å’Œ"], zhuyin: ["ã„ˆã„¨Ë‹", "ã„ã„œË‹"], targetIndex: 1, answer: "ã„ã„œË‹", options: ["ã„ã„œË‹", "ã„ã„œËŠ"] },
        { phrase: ["å°", "èª¿"], zhuyin: ["ã„‰ã„¨ã„ŸË‹", "ã„‰ã„§ã„ Ë‹"], targetIndex: 1, answer: "ã„‰ã„§ã„ Ë‹", options: ["ã„‰ã„§ã„ Ë‹", "ã„Šã„§ã„ ËŠ"] },
        { phrase: ["è²", "èª¿"], zhuyin: ["ã„•ã„¥", "ã„‰ã„§ã„ Ë‹"], targetIndex: 1, answer: "ã„‰ã„§ã„ Ë‹", options: ["ã„‰ã„§ã„ Ë‹", "ã„Šã„§ã„ ËŠ"] }
    ];

    const similarBank = [
        { phrase: ["å¹¸", "ç¦"], zhuyin: ["ã„’ã„§ã„¥Ë‹", "ã„ˆã„¨ËŠ"], missingIndex: 0, answer: "å¹¸", options: ["å¹¸", "è¾›"] },
        { phrase: ["è¾›", "è‹¦"], zhuyin: ["ã„’ã„§ã„£", "ã„ã„¨Ë‡"], missingIndex: 0, answer: "è¾›", options: ["å¹¸", "è¾›"] },
        { phrase: ["å–", "æ°´"], zhuyin: ["ã„ã„œ", "ã„•ã„¨ã„ŸË‡"], missingIndex: 0, answer: "å–", options: ["å–", "æ¸´"] },
        { phrase: ["å£", "æ¸´"], zhuyin: ["ã„ã„¡Ë‡", "ã„ã„œË‡"], missingIndex: 1, answer: "æ¸´", options: ["å–", "æ¸´"] },
        { phrase: ["é€²", "æ­¥"], zhuyin: ["ã„ã„§ã„£Ë‹", "ã„…ã„¨Ë‹"], missingIndex: 0, answer: "é€²", options: ["é€²", "è¿‘"] },
        { phrase: ["é ", "è¿‘"], zhuyin: ["ã„©ã„¢Ë‡", "ã„ã„§ã„£Ë‹"], missingIndex: 1, answer: "è¿‘", options: ["é€²", "è¿‘"] },
        { phrase: ["å¤ª", "é™½"], zhuyin: ["ã„Šã„Ë‹", "ã„§ã„¤ËŠ"], missingIndex: 1, answer: "é™½", options: ["é™½", "æ¹¯"] },
        { phrase: ["å–", "æ¹¯"], zhuyin: ["ã„ã„œ", "ã„Šã„¤"], missingIndex: 1, answer: "æ¹¯", options: ["é™½", "æ¹¯"] },
        { phrase: ["æ¹–", "æ³Š"], zhuyin: ["ã„ã„¨ËŠ", "ã„…ã„›ËŠ"], missingIndex: 0, answer: "æ¹–", options: ["æ¹–", "è´"] },
        { phrase: ["è´", "è¶"], zhuyin: ["ã„ã„¨ËŠ", "ã„‰ã„§ã„ËŠ"], missingIndex: 0, answer: "è´", options: ["æ¹–", "è´"] },
        { phrase: ["åœ‹", "å®¶"], zhuyin: ["ã„ã„¨ã„›ËŠ", "ã„ã„§ã„š"], missingIndex: 0, answer: "åœ‹", options: ["åœ‹", "åœ–"] },
        { phrase: ["åœ–", "ç•«"], zhuyin: ["ã„Šã„¨ËŠ", "ã„ã„¨ã„šË‹"], missingIndex: 0, answer: "åœ–", options: ["åœ‹", "åœ–"] },
        { phrase: ["ç§‘", "å­¸"], zhuyin: ["ã„ã„œ", "ã„’ã„©ã„ËŠ"], missingIndex: 0, answer: "ç§‘", options: ["ç§‘", "æ–™"] },
        { phrase: ["é£²", "æ–™"], zhuyin: ["ã„§ã„£Ë‡", "ã„Œã„§ã„ Ë‹"], missingIndex: 1, answer: "æ–™", options: ["ç§‘", "æ–™"] },
        { phrase: ["é²", "åˆ°"], zhuyin: ["ã„”ËŠ", "ã„‰ã„ Ë‹"], missingIndex: 1, answer: "åˆ°", options: ["åˆ°", "å€’"] },
        { phrase: ["è·Œ", "å€’"], zhuyin: ["ã„‰ã„§ã„ËŠ", "ã„‰ã„ Ë‡"], missingIndex: 1, answer: "å€’", options: ["åˆ°", "å€’"] },
        { phrase: ["è¸©", "è¸"], zhuyin: ["ã„˜ã„Ë‡", "ã„Šã„šË‹"], missingIndex: 0, answer: "è¸©", options: ["è¸©", "æ¡"] },
        { phrase: ["æ¡", "èŠ±"], zhuyin: ["ã„˜ã„Ë‡", "ã„ã„¨ã„š"], missingIndex: 0, answer: "æ¡", options: ["è¸©", "æ¡"] },
        { phrase: ["ç¶¿", "ç¾Š"], zhuyin: ["ã„‡ã„§ã„¢ËŠ", "ã„§ã„¤ËŠ"], missingIndex: 0, answer: "ç¶¿", options: ["ç¶¿", "æ£‰"] },
        { phrase: ["æ£‰", "è¢«"], zhuyin: ["ã„‡ã„§ã„¢ËŠ", "ã„…ã„ŸË‹"], missingIndex: 0, answer: "æ£‰", options: ["ç¶¿", "æ£‰"] },
        { phrase: ["è¿·", "è·¯"], zhuyin: ["ã„‡ã„§ËŠ", "ã„Œã„¨Ë‹"], missingIndex: 0, answer: "è¿·", options: ["è¿·", "è¬"] },
        { phrase: ["è¬", "èª"], zhuyin: ["ã„‡ã„§ËŠ", "ã„©Ë‡"], missingIndex: 0, answer: "è¬", options: ["è¿·", "è¬"] },
        { phrase: ["é€›", "è¡—"], zhuyin: ["ã„ã„¨ã„¤Ë‹", "ã„ã„§ã„"], missingIndex: 0, answer: "é€›", options: ["é€›", "ç‹‚"] },
        { phrase: ["ç˜‹", "ç‹‚"], zhuyin: ["ã„ˆã„¥", "ã„ã„¨ã„¤ËŠ"], missingIndex: 1, answer: "ç‹‚", options: ["é€›", "ç‹‚"] },
        { phrase: ["é€²", "å‡º"], zhuyin: ["ã„ã„§ã„£Ë‹", "ã„”ã„¨"], missingIndex: 0, answer: "é€²", options: ["é€²", "è¿‘"] },
        { phrase: ["å€’", "å½±"], zhuyin: ["ã„‰ã„ Ë‹", "ã„§ã„¥Ë‡"], missingIndex: 0, answer: "å€’", options: ["å€’", "åˆ°"] },
        { phrase: ["è¸¢", "çƒ"], zhuyin: ["ã„Šã„§", "ã„‘ã„§ã„¡ËŠ"], missingIndex: 0, answer: "è¸¢", options: ["è¸¢", "æ¦"] },
        { phrase: ["æ¨¹", "æ"], zhuyin: ["ã„•ã„¨Ë‹", "ã„“"], missingIndex: 1, answer: "æ", options: ["æ", "æ”¯"] },
        { phrase: ["ç›´", "åˆ°"], zhuyin: ["ã„“ËŠ", "ã„‰ã„ Ë‹"], missingIndex: 0, answer: "ç›´", options: ["ç›´", "å€¼"] },
        { phrase: ["ä¾¿", "å®œ"], zhuyin: ["ã„†ã„§ã„¢ËŠ", "ã„§ËŠ"], missingIndex: 0, answer: "ä¾¿", options: ["ä¾¿", "æ›´"] },
        { phrase: ["æ¨", "é€²"], zhuyin: ["ã„Šã„¨ã„Ÿ", "ã„ã„§ã„£Ë‹"], missingIndex: 1, answer: "é€²", options: ["é€²", "è¿‘"] },
        { phrase: ["é‹", "æ°£"], zhuyin: ["ã„©ã„£Ë‹", "ã„‘ã„§Ë‹"], missingIndex: 0, answer: "é‹", options: ["é‹", "æ®"] },
        { phrase: ["èº«", "é«˜"], zhuyin: ["ã„•ã„£", "ã„ã„ "], missingIndex: 0, answer: "èº«", options: ["èº«", "ç”Ÿ"] },
	{ phrase: ["ç”Ÿ", "é•·"], zhuyin: ["ã„•ã„¥", "ã„“ã„¤Ë‡"], missingIndex: 0, answer: "ç”Ÿ", options: ["èº«", "ç”Ÿ"] }, 
        { phrase: ["è©±", "åŠ‡"], zhuyin: ["ã„ã„¨ã„šË‹", "ã„ã„©Ë‹"], missingIndex: 0, answer: "è©±", options: ["è©±", "æ´»"] }
    ];

    let currentMode = '';
    let currentQuestions = [];
    let currentIndex = 0;
    let isProcessing = false;
    let wrongAnswers = [];
    let gameStartTime;

    function parseZhuyin(text) {
        if (!text) return { bopo: [], tone: '', toneType: 'none' };
        if (text.includes('Ë™')) {
            const bopoStr = text.replace('Ë™', '');
            return { bopo: bopoStr.split(''), tone: 'Ë™', toneType: 'top' };
        }
        const tones = ['ËŠ', 'Ë‡', 'Ë‹'];
        const lastChar = text.slice(-1);
        if (tones.includes(lastChar)) {
            const bopoStr = text.slice(0, -1);
            return { bopo: bopoStr.split(''), tone: lastChar, toneType: 'side' };
        }
        return { bopo: text.split(''), tone: '', toneType: 'none' };
    }

    function createZhuyinHTML(zhuyinStr) {
        const data = parseZhuyin(zhuyinStr);
        const wrapper = document.createElement('div');
        wrapper.className = 'zhuyin-wrapper';
        if (data.toneType === 'top') {
            const toneDiv = document.createElement('div');
            toneDiv.className = 'zhuyin-tone-top';
            toneDiv.innerText = data.tone;
            wrapper.appendChild(toneDiv);
        }
        const bopoCol = document.createElement('div');
        bopoCol.className = 'zhuyin-bopo-col';
        data.bopo.forEach(char => {
            const charDiv = document.createElement('div');
            charDiv.innerText = char;
            bopoCol.appendChild(charDiv);
        });
        wrapper.appendChild(bopoCol);
        if (data.toneType === 'side') {
            const toneDiv = document.createElement('div');
            toneDiv.className = 'zhuyin-tone-side';
            toneDiv.innerText = data.tone;
            wrapper.appendChild(toneDiv);
        }
        return wrapper;
    }

    function goHomeConfirm() { if(confirm("ç¢ºå®šè¦å›å»å—ï¼Ÿ")) goHome(); }
    
    function goHome() {
        document.getElementById('home-screen').style.display = 'flex';
        document.getElementById('game-screen').style.display = 'none';
        document.getElementById('complete-screen').style.display = 'none';
        stopConfetti();
    }

    function startGame(mode) {
        currentMode = mode;
        let sourceBank;
        
        if (mode === 'word') sourceBank = wordBank;
        else if (mode === 'polyphone') sourceBank = polyphoneBank;
        else if (mode === 'similar') sourceBank = similarBank;

        let shuffled = shuffle([...sourceBank]);
        currentQuestions = shuffled.slice(0, 10);
        
        currentIndex = 0;
        wrongAnswers = [];
        gameStartTime = Date.now();
        
        document.getElementById('home-screen').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        document.getElementById('complete-screen').style.display = 'none';
        
        document.getElementById('total-levels').innerText = currentQuestions.length;
        loadLevel();
    }

    function restartLevel() { 
        stopConfetti();
        startGame(currentMode); 
    }

    function loadLevel() {
        isProcessing = false;
        const q = currentQuestions[currentIndex];
        
        updateProgress();
        const feedback = document.getElementById('feedback');
        feedback.innerText = "âœ¨ åŠ æ²¹ï¼";
        feedback.style.color = "#FFB74D";
        
        const gridContainer = document.getElementById('word-grid');
        gridContainer.innerHTML = '';
        
        q.phrase.forEach((char, index) => {
            const charContainer = document.createElement('div');
            charContainer.className = 'char-container';
            const box = document.createElement('div');
            box.className = 'grid-box';
            const content = document.createElement('span');
            content.className = 'grid-content';
            
            if (currentMode === 'word' || currentMode === 'similar') {
                if (index === q.missingIndex) {
                    box.classList.add('empty');
                    content.innerText = "";
                    content.id = 'target-char';
                } else {
                    content.innerText = char;
                }
            } else {
                content.innerText = char;
                if (index === q.targetIndex) box.classList.add('highlight');
            }
            box.appendChild(content);
            charContainer.appendChild(box);

            let zhuyinElement;
            if (currentMode === 'word' || currentMode === 'similar') {
                if (index !== q.missingIndex) {
                    zhuyinElement = createZhuyinHTML(q.zhuyin[index]);
                } else {
                    zhuyinElement = document.createElement('div');
                    zhuyinElement.className = 'zhuyin-wrapper'; 
                    zhuyinElement.id = 'target-zhuyin-container';
                }
            } else {
                if (index !== q.targetIndex) {
                    zhuyinElement = createZhuyinHTML(q.zhuyin[index]);
                } else {
                    zhuyinElement = document.createElement('div');
                    zhuyinElement.className = 'zhuyin-wrapper';
                    zhuyinElement.innerHTML = '<div style="font-size:1.5rem; color:#ccc;">?</div>';
                    zhuyinElement.id = 'target-zhuyin-container';
                }
            }
            charContainer.appendChild(zhuyinElement);
            gridContainer.appendChild(charContainer);
        });

        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = '';
        const shuffledOptions = shuffle([...q.options]);
        
        shuffledOptions.forEach(opt => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.dataset.answer = opt;
            
            if (currentMode === 'polyphone') {
                btn.classList.add('zhuyin-mode');
                btn.appendChild(createZhuyinHTML(opt));
            } else {
                btn.innerText = opt;
            }
            
            btn.onclick = () => checkAnswer(btn, opt, q.answer, q);
            optionsContainer.appendChild(btn);
        });
    }

    function teachMe() {
        if (isProcessing) return;
        isProcessing = true;
        
        const q = currentQuestions[currentIndex];
        
        const alreadyWrong = wrongAnswers.some(w => w.question === q);
        if (!alreadyWrong) wrongAnswers.push({ question: q, yourAns: "(æ±‚æ•‘)" });

        const buttons = document.querySelectorAll('.option-btn');
        let correctBtn;
        buttons.forEach(btn => {
            if (btn.dataset.answer === q.answer) correctBtn = btn;
        });

        if (correctBtn) {
            correctBtn.classList.add('correct');
        }

        if (currentMode === 'word' || currentMode === 'similar') {
            document.getElementById('target-char').innerText = q.answer;
            const targetZhuyinContainer = document.getElementById('target-zhuyin-container');
            targetZhuyinContainer.innerHTML = '';
            targetZhuyinContainer.appendChild(createZhuyinHTML(q.zhuyin[q.missingIndex]));
            document.querySelector('.grid-box.empty').classList.remove('empty');
        } else {
            const targetZhuyinContainer = document.getElementById('target-zhuyin-container');
            targetZhuyinContainer.innerHTML = '';
            const correctZhuyinHTML = createZhuyinHTML(q.answer);
            correctZhuyinHTML.querySelectorAll('div').forEach(d => d.style.color = '#81C784');
            targetZhuyinContainer.appendChild(correctZhuyinHTML);
            document.querySelector('.grid-box.highlight').style.borderColor = '#81C784';
        }

        const feedback = document.getElementById('feedback');
        feedback.innerText = "ğŸŒŸ æ²’é—œä¿‚ï¼Œæˆ‘å€‘ä¸€èµ·è¨˜ä½å®ƒï¼";
        feedback.style.color = "#AB47BC"; 

        setTimeout(() => {
            currentIndex++;
            if (currentIndex < currentQuestions.length) {
                loadLevel();
            } else {
                document.getElementById('progress-bar').style.width = '100%';
                showComplete();
            }
        }, 2000);
    }

    function checkAnswer(btn, selected, correct, questionData) {
        if (isProcessing) return;
        
        const feedback = document.getElementById('feedback');
        
        if (selected === correct) {
            isProcessing = true;
            btn.classList.add('correct');
            playSound('correct');
            
            if (currentMode === 'word' || currentMode === 'similar') {
                document.getElementById('target-char').innerText = correct;
                const targetZhuyinContainer = document.getElementById('target-zhuyin-container');
                targetZhuyinContainer.innerHTML = '';
                targetZhuyinContainer.appendChild(createZhuyinHTML(questionData.zhuyin[questionData.missingIndex]));
                document.querySelector('.grid-box.empty').classList.remove('empty');
            } else {
                const targetZhuyinContainer = document.getElementById('target-zhuyin-container');
                targetZhuyinContainer.innerHTML = '';
                const correctZhuyinHTML = createZhuyinHTML(correct);
                correctZhuyinHTML.querySelectorAll('div').forEach(d => d.style.color = '#81C784');
                targetZhuyinContainer.appendChild(correctZhuyinHTML);
                document.querySelector('.grid-box.highlight').style.borderColor = '#81C784';
            }
            
            feedback.innerText = "â­• ç­”å°äº†ï¼å¥½æ£’ï¼";
            feedback.style.color = "#81C784";
            
            setTimeout(() => {
                currentIndex++;
                if (currentIndex < currentQuestions.length) {
                    loadLevel();
                } else {
                    document.getElementById('progress-bar').style.width = '100%';
                    showComplete();
                }
            }, 1200);
        } else {
            const alreadyWrong = wrongAnswers.some(w => w.question === questionData);
            if (!alreadyWrong) wrongAnswers.push({ question: questionData, yourAns: selected });

            btn.classList.add('wrong');
            playSound('wrong');
            feedback.innerText = "âŒ å“å‘€ï¼Œå†æƒ³ä¸€æƒ³å–”ï¼";
            feedback.style.color = "#E57373";
            
            setTimeout(() => {
                btn.classList.remove('wrong');
                feedback.innerText = "ğŸ’ª åŠ æ²¹ï¼Œä½ å¯ä»¥çš„ï¼";
                feedback.style.color = "#FFB74D";
            }, 1000);
        }
    }

    function showComplete() {
        document.getElementById('game-screen').style.display = 'none';
        document.getElementById('complete-screen').style.display = 'flex';
        
        const score = currentQuestions.length - wrongAnswers.length;
        const finalScoreText = score === 10 ? "å¤ªå²å®³äº†ï¼å…¨éƒ¨ç­”å°ï¼ğŸ†" : `ç­”å°äº† ${score} é¡Œï¼Œç¹¼çºŒåŠ æ²¹ï¼`;
        document.getElementById('final-score').innerText = finalScoreText;

        const endTime = Date.now();
        const totalSeconds = Math.floor((endTime - gameStartTime) / 1000);
        const minutes = Math.floor(totalSeconds / 60);
        const seconds = totalSeconds % 60;
        let timeString = "";
        if (minutes > 0) timeString += `${minutes} åˆ† `;
        timeString += `${seconds} ç§’`;
        document.getElementById('time-result').innerText = `â±ï¸ å…±èŠ±äº† ${timeString}`;

        const reviewContainer = document.getElementById('review-container');
        const reviewItems = document.getElementById('review-items');
        reviewItems.innerHTML = '';

        if (wrongAnswers.length > 0) {
            reviewContainer.style.display = 'block';
            wrongAnswers.forEach(item => {
                const q = item.question;
                const div = document.createElement('div');
                div.className = 'review-card';
                
                let htmlContent = '';
                
                q.phrase.forEach((char, index) => {
                    let isTarget = false;
                    
                    if (currentMode === 'word' || currentMode === 'similar') {
                        isTarget = (index === q.missingIndex);
                    } else {
                        isTarget = (index === q.targetIndex);
                    }
                    
                    if (isTarget) {
                        if (currentMode === 'polyphone') {
                            htmlContent += `<span class="review-correct-char zhuyin">${q.answer}</span>`;
                        } else {
                            htmlContent += `<span class="review-correct-char">${q.answer}</span>`;
                        }
                    } else {
                        htmlContent += char;
                    }
                });

                div.innerHTML = `
                    <div class="review-text">${htmlContent}</div>
                `;
                reviewItems.appendChild(div);
            });
        } else {
            reviewContainer.style.display = 'none';
            startConfetti();
        }
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function updateProgress() {
        const percent = (currentIndex / currentQuestions.length) * 100;
        document.getElementById('progress-bar').style.width = percent + '%';
        document.getElementById('current-level').innerText = currentIndex + 1;
    }

    let confettiFrame;
    function startConfetti() {
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const particles = Array.from({length: 150}, () => ({
            x: Math.random()*canvas.width, y: Math.random()*canvas.height-canvas.height,
            c: ['#F48FB1','#81D4FA','#FFAB91','#FFE082'][Math.floor(Math.random()*4)],
            s: Math.random()*3+2, a: Math.random()*360
        }));
        function draw() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach(p => {
                p.y += p.s; p.a += 0.1;
                ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.a); ctx.fillStyle = p.c;
                ctx.fillRect(-6,-6,12,12); ctx.restore();
                if(p.y > canvas.height) p.y = -10;
            });
            confettiFrame = requestAnimationFrame(draw);
        }
        draw();
    }
    function stopConfetti() {
        if(confettiFrame) cancelAnimationFrame(confettiFrame);
        const canvas = document.getElementById('confetti-canvas');
        if(canvas) canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
    }
</script>
</body>
</html>